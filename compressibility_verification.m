function compressibility_verification

TR = [1.1 1.2 1.3 1.5 2];
PR = linspace(0,7,1000); PR(1) = 0.001;
X = [0.8000 0.1000 0.0200 0.0200 0.0200 0.0000 0.0000 0.0000 0.0000 0.0000 0.0200 0.0200 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000];

MWi = [16.043 28.0134 44.01 30.07 44.097 18.0153 34.08 2.1059 28.01 31.9988 58.123 58.123 72.15 72.15 86.177 100.204 114.231 128.258 142.285 4.0026 39.948];
TCi = [343 227.16 547.58 549.59 665.73 164.85 672.35 59.36 239.26 278.24 734.13 765.29 828.77 845.47 913.27 972.37 1023.89 70.35 1111.67 9.34 271.55];
PCi = [666.4 493.1 1071 706.5 616 3200.1 1306 187.5 507.5 731.4 527.9 550.6 490.4 488.6 436.9 396.8 360.7 331.8 305.2 32.9 710.4];

 M = sum(X.*MWi);
TC = sum(X.*TCi);
PC = sum(X.*PCi);

figure; hold on;
for tr = TR
    T = tr * TC;
    Z = compressibility(T, PR * PC, repmat(X, length(PR), 1));
    plot(PR,Z,'-');
end

xlim([0 7]);
ylim([.1 1.1]);
saveas(gca,'z_aga8.png');
